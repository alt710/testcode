Test Code there is still more improvement to due not managed to finish